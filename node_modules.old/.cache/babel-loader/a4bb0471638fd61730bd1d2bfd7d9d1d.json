{"ast":null,"code":"import _defineProperty from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport { detectForm } from '../../../../hook/before';\nimport error from '../../../../hook/after/error';\n\nvar formController =\n/*#__PURE__*/\nfunction () {\n  function formController(model) {\n    var dispatcher = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    _classCallCheck(this, formController);\n\n    this.active = false;\n    /* FOR OPEN MODAL */\n\n    this.state = {\n      typeAction: '',\n      onAction: '',\n      status: ''\n    };\n    this.data = {};\n    this.model = model;\n    this.dispatcher = dispatcher || null;\n  }\n\n  _createClass(formController, [{\n    key: \"_stateDataTemp\",\n    value: function _stateDataTemp() {\n      return {\n        code: '',\n        name: '',\n        is_serial: 0,\n        categories_id: 0,\n        supplier_codes: '',\n        price_1: 0,\n        price_2: 0,\n        price_3: 0,\n        price_4: 0,\n        unit: 0,\n        type: 'root',\n        images: '',\n        content: ''\n      };\n    }\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit() {\n      var _this = this;\n\n      var typeAction = this.state.typeAction;\n      /* PUT - POST */\n\n      /* HOOKED detectForm before save data*/\n      // -->\n\n      var fields = ['code', 'name', 'categories_id', 'supplier_codes', 'unit'];\n\n      if (detectForm(fields, this.data) === '') {\n        this.model.axios(typeAction, this.data, function (res) {\n          _this._whereStateChange({\n            onAction: 'onSubmit',\n            status: res.name\n          }); // on success \n          //res.name === 'success' ? this.toggle() : error(this.model.model) ;  \n\n        });\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(name, value) {\n      //Object.assign(this.data,{ [name]:e.target.value});\n      Object.assign(this.data, _defineProperty({}, name, value));\n\n      if (name !== 'content') {\n        this.processForm(name, value);\n      }\n    }\n    /* START : HOW */\n\n  }, {\n    key: \"open\",\n    value: function open(typeAction, info) {\n      //const {temp} = info || FORM_TEMP ;\n      this.data = info || this._stateDataTemp();\n      this.active = true;\n\n      this._whereStateChange({\n        typeAction: typeAction,\n        onAction: 'open',\n        status: 'opened'\n      });\n    }\n  }, {\n    key: \"processForm\",\n    value: function processForm(name, e) {\n      //-->\n      this._whereStateChange({\n        onAction: 'processForm'\n      });\n    }\n  }, {\n    key: \"toggle\",\n    value: function toggle() {\n      this.active = !this.active; // -->\n\n      this._whereStateChange({\n        onAction: 'toggle_modal',\n        status: 'closed'\n      });\n    }\n    /* START : WHERE */\n\n  }, {\n    key: \"_whereStateChange\",\n    value: function _whereStateChange() {\n      var _this2 = this;\n\n      var newState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // passing form state to index \n      Object.assign(this.state, newState);\n\n      if (this.dispatcher !== null) {\n        this.dispatcher({\n          type: 'STATE-' + this.model.model,\n          state: this.state\n        });\n      }\n\n      window.setTimeout(function () {\n        newState.status === 'success' ? _this2.toggle() : error(_this2.model.model);\n      }, 1000);\n    }\n  }]);\n\n  return formController;\n}();\n\nexport default formController;","map":{"version":3,"sources":["D:/actions/st_frontend/src/pages/Order/Setting/productPage/formCtrl.js"],"names":["detectForm","error","formController","model","dispatcher","active","state","typeAction","onAction","status","data","code","name","is_serial","categories_id","supplier_codes","price_1","price_2","price_3","price_4","unit","type","images","content","fields","axios","res","_whereStateChange","value","Object","assign","processForm","info","_stateDataTemp","e","newState","window","setTimeout","toggle"],"mappings":"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","sourcesContent":["\r\nimport { detectForm } from '../../../../hook/before';\r\nimport error from '../../../../hook/after/error' ; \r\n\r\n\r\nclass formController {\r\n\r\n    constructor(model,dispatcher=null){\r\n      this.active = false ; /* FOR OPEN MODAL */\r\n\r\n      this.state = {\r\n        typeAction:'',\r\n        onAction:'',\r\n        status:''\r\n      }\r\n\r\n      this.data = {};\r\n      this.model = model ;\r\n      this.dispatcher = dispatcher || null ; \r\n\r\n      \r\n\r\n    }\r\n\r\n    _stateDataTemp(){\r\n      return {\r\n        code:'',\r\n        name:'',\r\n        is_serial:0,\r\n        categories_id:0,\r\n        supplier_codes:'',\r\n        price_1:0,\r\n        price_2:0,\r\n        price_3:0,\r\n        price_4:0,\r\n        unit:0,\r\n        type:'root',\r\n        images:'',\r\n        content:''\r\n      }\r\n    }\r\n\r\n    onSubmit(){\r\n\r\n      const typeAction = this.state.typeAction; /* PUT - POST */\r\n      /* HOOKED detectForm before save data*/\r\n      // -->\r\n      const fields = [\r\n        'code','name','categories_id','supplier_codes','unit'\r\n      ];\r\n\r\n      \r\n      \r\n      if(detectForm(fields,this.data)===''){\r\n\r\n          this.model.axios(typeAction,this.data,(res)=>{\r\n            \r\n            this._whereStateChange({\r\n              onAction:'onSubmit',\r\n              status:res.name\r\n            });\r\n\r\n            // on success \r\n            //res.name === 'success' ? this.toggle() : error(this.model.model) ;  \r\n            \r\n          })\r\n      }\r\n\r\n    }\r\n\r\n    onChange(name, value){\r\n      //Object.assign(this.data,{ [name]:e.target.value});\r\n      Object.assign(this.data,{ [name]:value});\r\n      \r\n      if(name!=='content'){\r\n        this.processForm(name,value);\r\n      }\r\n\r\n    }\r\n\r\n    /* START : HOW */\r\n    open(typeAction, info){\r\n\r\n      //const {temp} = info || FORM_TEMP ;\r\n      this.data = info || this._stateDataTemp() ;\r\n      this.active = true ;\r\n\r\n      this._whereStateChange({\r\n        typeAction:typeAction,   \r\n        onAction:'open',\r\n        status:'opened'\r\n      });\r\n\r\n    }\r\n\r\n    processForm(name,e){\r\n       //-->\r\n       this._whereStateChange({\r\n         onAction:'processForm'\r\n       });\r\n\r\n    }\r\n\r\n\r\n    toggle(){\r\n\r\n      this.active = !this.active;\r\n      // -->\r\n      this._whereStateChange({\r\n        onAction:'toggle_modal',\r\n        status:'closed',\r\n      });\r\n      \r\n    }\r\n\r\n    /* START : WHERE */\r\n    _whereStateChange(newState={}){\r\n      \r\n      // passing form state to index \r\n      Object.assign(this.state,newState);\r\n      if(this.dispatcher!==null){\r\n          this.dispatcher({\r\n              type:'STATE-'+this.model.model,\r\n              state:this.state\r\n          })\r\n      }\r\n\r\n      window.setTimeout(()=>{\r\n        newState.status === 'success' ? this.toggle() : error(this.model.model) ;\r\n      },1000)\r\n          \r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default formController;\r\n"]},"metadata":{},"sourceType":"module"}