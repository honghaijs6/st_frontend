{"ast":null,"code":"import _classCallCheck from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport feathers from '../feathers';\nvar CREATED = 'created';\nvar UPDATED = 'updated';\nvar REMOVED = 'removed';\n\nvar Socket =\n/*#__PURE__*/\nfunction () {\n  function Socket(service) {\n    _classCallCheck(this, Socket);\n\n    /* WHAT : DATA */\n    this.model = service;\n    this.state = {\n      onAction: '',\n      status: '',\n      timeout: 5000,\n      time_resp: 2000,\n      res: {}\n    };\n    /*  initial WHO */\n\n    this._setup();\n  }\n  /* WHEN */\n\n\n  _createClass(Socket, [{\n    key: \"clientListenServer\",\n    value: function clientListenServer(onSuccess) {\n      var _this2 = this;\n\n      var _this = this;\n\n      this.service.on(CREATED, function (res) {\n        _this2._socketResp(res);\n\n        window.setTimeout(function () {\n          onSuccess(res);\n        }, _this2.state.time_resp);\n      });\n      this.service.on(UPDATED, function (res) {\n        _this2._socketResp(res);\n\n        window.setTimeout(function () {\n          onSuccess(res);\n        }, _this2.state.time_resp);\n      });\n      this.service.on(REMOVED, function (res) {\n        _this2._socketResp(res);\n\n        window.setTimeout(function () {\n          onSuccess(res);\n        }, _this2.state.time_resp);\n      });\n    }\n    /* END WHEN */\n\n    /* HOW */\n\n  }, {\n    key: \"_setup\",\n    value: function _setup() {\n      this.service = feathers.service(this.model);\n      this.service.timeout = this.state.timeout;\n\n      this._whereStateChange({\n        onAction: 'setup'\n      });\n    }\n  }, {\n    key: \"_reset\",\n    value: function _reset(status) {\n      this.service = feathers.service(this.model);\n      this.service.timeout = this.state.timeout;\n\n      this._whereStateChange({\n        onAction: 'reset',\n        status: status\n      });\n    }\n  }, {\n    key: \"setTimeDelay\",\n    value: function setTimeDelay(num) {\n      this.state['time_resp'] = num;\n\n      this._reset('setTimeout');\n    }\n  }, {\n    key: \"setTimeout\",\n    value: function setTimeout(num) {\n      this.state['timeout'] = num;\n\n      this._reset('setTimeout');\n    }\n  }, {\n    key: \"_socketResp\",\n    value: function _socketResp(res) {\n      this._whereStateChange({\n        onAction: 'socketResp',\n        res: res\n      });\n    }\n    /* END HOW  */\n\n    /* WHERE */\n\n  }, {\n    key: \"_whereStateChange\",\n    value: function _whereStateChange(newState) {\n      Object.assign(this.state, newState);\n      /* write socket log here */\n    }\n    /* RESONE TRUC TIẾP */\n\n    /*create(data={}){ this.socket.create(data)}\r\n    update(id=null,data={}){ this.socket.update(id,data,{}) }\r\n    remove(id=null){ this.socket.remove(id,{ query:{ cascade:true} })  }*/\n\n  }]);\n\n  return Socket;\n}();\n\nSocket.client = feathers;\nexport { Socket as default };","map":{"version":3,"sources":["D:/actions/st_frontend/src/model/socket.js"],"names":["feathers","CREATED","UPDATED","REMOVED","Socket","service","model","state","onAction","status","timeout","time_resp","res","_setup","onSuccess","_this","on","_socketResp","window","setTimeout","_whereStateChange","num","_reset","newState","Object","assign","client"],"mappings":";;AAEA,OAAOA,QAAP,MAAqB,aAArB;AAEA,IAAOC,OAAO,GAAG,SAAjB;AACA,IAAOC,OAAO,GAAG,SAAjB;AACA,IAAOC,OAAO,GAAG,SAAjB;;IAGqBC,M;;;AAInB,kBAAYC,OAAZ,EAAoB;AAAA;;AAGlB;AACA,SAAKC,KAAL,GAAaD,OAAb;AACA,SAAKE,KAAL,GAAa;AACXC,MAAAA,QAAQ,EAAC,EADE;AAEXC,MAAAA,MAAM,EAAG,EAFE;AAGXC,MAAAA,OAAO,EAAC,IAHG;AAIXC,MAAAA,SAAS,EAAC,IAJC;AAKXC,MAAAA,GAAG,EAAC;AALO,KAAb;AASA;;AACA,SAAKC,MAAL;AAGD;AAED;;;;;uCACmBC,S,EAAU;AAAA;;AACzB,UAAMC,KAAK,GAAG,IAAd;;AAEA,WAAKV,OAAL,CAAaW,EAAb,CAAgBf,OAAhB,EAAwB,UAACW,GAAD,EAAO;AAE7B,QAAA,MAAI,CAACK,WAAL,CAAiBL,GAAjB;;AAEAM,QAAAA,MAAM,CAACC,UAAP,CAAkB,YAAI;AACpBL,UAAAA,SAAS,CAACF,GAAD,CAAT;AACD,SAFD,EAEE,MAAI,CAACL,KAAL,CAAWI,SAFb;AAID,OARD;AAUA,WAAKN,OAAL,CAAaW,EAAb,CAAgBd,OAAhB,EAAwB,UAACU,GAAD,EAAO;AAE7B,QAAA,MAAI,CAACK,WAAL,CAAiBL,GAAjB;;AAEAM,QAAAA,MAAM,CAACC,UAAP,CAAkB,YAAI;AACpBL,UAAAA,SAAS,CAACF,GAAD,CAAT;AACD,SAFD,EAEE,MAAI,CAACL,KAAL,CAAWI,SAFb;AAGD,OAPD;AASA,WAAKN,OAAL,CAAaW,EAAb,CAAgBb,OAAhB,EAAwB,UAACS,GAAD,EAAO;AAE7B,QAAA,MAAI,CAACK,WAAL,CAAiBL,GAAjB;;AAEAM,QAAAA,MAAM,CAACC,UAAP,CAAkB,YAAI;AACpBL,UAAAA,SAAS,CAACF,GAAD,CAAT;AACD,SAFD,EAEE,MAAI,CAACL,KAAL,CAAWI,SAFb;AAGD,OAPD;AASH;AACD;;AAGA;;;;6BACQ;AACN,WAAKN,OAAL,GAAeL,QAAQ,CAACK,OAAT,CAAiB,KAAKC,KAAtB,CAAf;AACA,WAAKD,OAAL,CAAaK,OAAb,GAAuB,KAAKH,KAAL,CAAWG,OAAlC;;AAEA,WAAKU,iBAAL,CAAuB;AACrBZ,QAAAA,QAAQ,EAAC;AADY,OAAvB;AAGD;;;2BAEMC,M,EAAO;AACZ,WAAKJ,OAAL,GAAeL,QAAQ,CAACK,OAAT,CAAiB,KAAKC,KAAtB,CAAf;AACA,WAAKD,OAAL,CAAaK,OAAb,GAAuB,KAAKH,KAAL,CAAWG,OAAlC;;AAEA,WAAKU,iBAAL,CAAuB;AACrBZ,QAAAA,QAAQ,EAAC,OADY;AAErBC,QAAAA,MAAM,EAACA;AAFc,OAAvB;AAID;;;iCAEYY,G,EAAI;AACb,WAAKd,KAAL,CAAW,WAAX,IAA0Bc,GAA1B;;AACA,WAAKC,MAAL,CAAY,YAAZ;AAEH;;;+BACUD,G,EAAI;AACb,WAAKd,KAAL,CAAW,SAAX,IAAwBc,GAAxB;;AACA,WAAKC,MAAL,CAAY,YAAZ;AACD;;;gCAEWV,G,EAAI;AAEd,WAAKQ,iBAAL,CAAuB;AACrBZ,QAAAA,QAAQ,EAAC,YADY;AAErBI,QAAAA,GAAG,EAACA;AAFiB,OAAvB;AAID;AACD;;AAGA;;;;sCACkBW,Q,EAAS;AACzBC,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKlB,KAAnB,EAAyBgB,QAAzB;AAEA;AACD;AAED;;AAIA;;;;;;;;;AA/GmBnB,M,CAEZsB,M,GAAS1B,Q;SAFGI,M","sourcesContent":["\r\n\r\nimport feathers from '../feathers'\r\n\r\nconst  CREATED = 'created';\r\nconst  UPDATED = 'updated';\r\nconst  REMOVED = 'removed';\r\n\r\n\r\nexport default class Socket {\r\n\r\n  static client = feathers\r\n\r\n  constructor(service){\r\n\r\n\r\n    /* WHAT : DATA */\r\n    this.model = service;\r\n    this.state = {\r\n      onAction:'',\r\n      status : '',\r\n      timeout:5000,\r\n      time_resp:2000,\r\n      res:{}\r\n    };\r\n\r\n\r\n    /*  initial WHO */\r\n    this._setup()\r\n\r\n\r\n  }\r\n\r\n  /* WHEN */\r\n  clientListenServer(onSuccess){\r\n      const _this = this ;\r\n\r\n      this.service.on(CREATED,(res)=>{\r\n\r\n        this._socketResp(res);\r\n\r\n        window.setTimeout(()=>{\r\n          onSuccess(res);\r\n        },this.state.time_resp)\r\n\r\n      });\r\n\r\n      this.service.on(UPDATED,(res)=>{\r\n\r\n        this._socketResp(res);\r\n\r\n        window.setTimeout(()=>{\r\n          onSuccess(res);\r\n        },this.state.time_resp)\r\n      });\r\n\r\n      this.service.on(REMOVED,(res)=>{\r\n\r\n        this._socketResp(res);\r\n\r\n        window.setTimeout(()=>{\r\n          onSuccess(res);\r\n        },this.state.time_resp)\r\n      });\r\n\r\n  }\r\n  /* END WHEN */\r\n\r\n\r\n  /* HOW */\r\n  _setup(){\r\n    this.service = feathers.service(this.model) ;\r\n    this.service.timeout = this.state.timeout ;\r\n\r\n    this._whereStateChange({\r\n      onAction:'setup',\r\n    })\r\n  }\r\n\r\n  _reset(status){\r\n    this.service = feathers.service(this.model) ;\r\n    this.service.timeout = this.state.timeout ;\r\n\r\n    this._whereStateChange({\r\n      onAction:'reset',\r\n      status:status\r\n    })\r\n  }\r\n  \r\n  setTimeDelay(num){\r\n      this.state['time_resp'] = num;\r\n      this._reset('setTimeout');\r\n\r\n  }\r\n  setTimeout(num){\r\n    this.state['timeout'] = num ;\r\n    this._reset('setTimeout');\r\n  }\r\n\r\n  _socketResp(res){\r\n\r\n    this._whereStateChange({\r\n      onAction:'socketResp',\r\n      res:res\r\n    });\r\n  }\r\n  /* END HOW  */\r\n\r\n\r\n  /* WHERE */\r\n  _whereStateChange(newState){\r\n    Object.assign(this.state,newState);\r\n\r\n    /* write socket log here */\r\n  }\r\n\r\n  /* RESONE TRUC TIẾP */\r\n\r\n\r\n\r\n  /*create(data={}){ this.socket.create(data)}\r\n  update(id=null,data={}){ this.socket.update(id,data,{}) }\r\n  remove(id=null){ this.socket.remove(id,{ query:{ cascade:true} })  }*/\r\n\r\n\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}