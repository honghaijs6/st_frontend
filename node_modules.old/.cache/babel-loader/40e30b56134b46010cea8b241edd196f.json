{"ast":null,"code":"import _classCallCheck from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\actions\\\\st_frontend\\\\src\\\\pages\\\\Cashflow\\\\Summary\\\\index.js\";\n// DATA\nimport Model from '../../../model/model'; // HOOKS \n\nimport { myTime } from '../../../hook/ultil/myTime'; // LIBS \n\nimport numeral from 'numeral';\nimport moment from 'moment';\nimport React, { Component } from 'react';\nimport { Col, Row, ButtonGroup, Button } from 'reactstrap';\nimport BenTabs from '../../../components/BenTabs';\nimport BenTable from '../../../components/BenTable';\nimport RankDatePicker from '../../../components/RankDatePicker';\nvar MODE = 'bills';\n\nvar CashflowSummary =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CashflowSummary, _Component);\n\n  function CashflowSummary(props) {\n    var _this;\n\n    _classCallCheck(this, CashflowSummary);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CashflowSummary).call(this, props));\n\n    _this._loadAllSum = function () {\n      //alert(JSON.stringify(this.state));\n      _this._getSumary('object');\n\n      _this._getSumary('bill_account');\n    };\n\n    _this.state = {\n      onTab: 'object',\n      tabs: [{\n        icon: 'fa fa-user',\n        code: 'object',\n        name: 'Xem theo đối tượng'\n      }, {\n        icon: 'fa fa-credit-card',\n        code: 'bill_account',\n        name: 'Xem theo tài khoản'\n      }],\n      startDate: myTime.headMonthEn(),\n      endDate: myTime.curDateEn()\n    };\n    _this.grid_object = {\n      colums: [{\n        headerName: 'Đối tượng',\n        field: 'object',\n        width: '50%'\n      }, {\n        headerName: 'Thu',\n        field: 'thu',\n        width: '25%'\n      }, {\n        headerName: 'Chi',\n        field: 'chi',\n        width: '25%'\n      }],\n      rowData: []\n    };\n    _this.grid_bill_account = {\n      colums: [{\n        headerName: 'Đối tượng',\n        field: 'object',\n        width: '50%'\n      }, {\n        headerName: 'Thu',\n        field: 'thu',\n        width: '25%'\n      }, {\n        headerName: 'Chi',\n        field: 'chi',\n        width: '25%'\n      }],\n      rowData: []\n    };\n\n    _this._setup();\n\n    return _this;\n  }\n\n  _createClass(CashflowSummary, [{\n    key: \"_setup\",\n    value: function _setup() {\n      this.model = new Model(MODE);\n    }\n  }, {\n    key: \"_calculateSUM\",\n    value: function _calculateSUM(rows) {\n      var THU = 0;\n      var CHI = 0;\n      rows.map(function (item) {\n        THU += parseInt(item.thu);\n        CHI += parseInt(item.chi);\n      });\n      return {\n        object: React.createElement(\"span\", {\n          className: \"text-red text-uppercase\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81\n          },\n          __self: this\n        }, \" T\\u1ED5ng \"),\n        thu: THU,\n        chi: CHI\n      };\n    }\n  }, {\n    key: \"_formatForSumObject\",\n    value: function _formatForSumObject(data) {\n      var rows = [];\n      rows.push({\n        object: 'Nhân viên',\n        thu: data['USER_THU'],\n        chi: data['USER_CHI']\n      });\n      rows.push({\n        object: 'Khách hàng',\n        thu: data['CUSTOMER_THU'],\n        chi: data['CUSTOMER_CHI']\n      });\n      rows.push({\n        object: 'Nhà cung cấp',\n        thu: data['SUPPLIER_THU'],\n        chi: data['SUPPLIER_CHI']\n      });\n      rows.push({\n        object: 'Khác',\n        thu: data['OTHER_THU'],\n        chi: data['OTHER_THU']\n      });\n      rows.push(this._calculateSUM(rows));\n      rows = rows.map(function (item) {\n        return {\n          object: item.object,\n          thu: numeral(item.thu).format('0,0'),\n          chi: numeral(item.chi).format('0,0')\n        };\n      });\n      return rows;\n    }\n  }, {\n    key: \"_formatForSumBillAccount\",\n    value: function _formatForSumBillAccount(rows) {\n      rows.push(this._calculateSUM(rows));\n      var newRow = [];\n      rows.map(function (item) {\n        newRow.push({\n          object: item.object,\n          thu: numeral(item.thu).format('0,0'),\n          chi: numeral(item.chi).format('0,0')\n        });\n      });\n      return newRow;\n    }\n  }, {\n    key: \"_getSumary\",\n    value: function _getSumary(option) {\n      var _this2 = this;\n\n      var url = '/sumaryBy/' + option + '?start=' + this.state.startDate + '&end=' + this.state.endDate;\n      this.model.doCall(url, function (res) {\n        var ret = res.data;\n\n        if (ret.name === 'success') {\n          // FORMAT DATA FIRST\n          var data = ret.rows[0]; // RESUM BY OBJECT\n\n          switch (option) {\n            case 'object':\n              _this2['grid_object'].rowData = _this2._formatForSumObject(data);\n              break;\n\n            case 'bill_account':\n              _this2['grid_bill_account'].rowData = _this2._formatForSumBillAccount(ret.rows);\n              break;\n          }\n\n          _this2.setState({\n            status: ret.name\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._getSumary('object');\n\n      this._getSumary('bill_account');\n    }\n  }, {\n    key: \"_loadWithDate\",\n    value: function _loadWithDate(state) {\n      this.setState({\n        startDate: moment(state.start).format('YYYY-MM-DD'),\n        endDate: moment(state.end).format('YYYY-MM-DD')\n      });\n    }\n  }, {\n    key: \"findDup\",\n    // DBCABC\n    value: function findDup(str) {\n      var arr = {};\n      Object.keys(str.split('')).map(function (item) {\n        if (str.indexOf(item) > -1) {\n          arr.push({\n            item: item,\n            count: 1\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        className: \"animated fadeIn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(\"main\", {\n        className: \"div-main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          padding: 30\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: \"text-uppercase\",\n        style: {\n          marginBottom: 15\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, \" T\\u1ED5ng quan Thu - Chi \"), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: 10,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, React.createElement(BenTabs, {\n        onChangeTab: function onChangeTab(code) {\n          _this3.setState({\n            onTab: code\n          });\n        },\n        tabs: this.state.tabs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          padding: '30px 0 0 30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(ButtonGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(RankDatePicker, {\n        onChange: function onChange(state) {\n          _this3._loadWithDate(state);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }), React.createElement(Button, {\n        onClick: this._loadAllSum,\n        style: {\n          marginLeft: -10,\n          borderLeft: 0\n        },\n        className: \"btn btn-ubuntu\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-filter\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        style: {\n          padding: 30\n        },\n        className: \"tab-pane  \".concat(this.state.onTab === 'object' ? 'active' : '', \" \"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(BenTable, {\n        grid: this.grid_object,\n        height: \"42vh\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          padding: 30\n        },\n        className: \"tab-pane  \".concat(this.state.onTab === 'bill_account' ? 'active' : '', \" \"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(BenTable, {\n        grid: this.grid_bill_account,\n        height: \"42vh\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }))))))));\n    }\n  }]);\n\n  return CashflowSummary;\n}(Component);\n\nexport default CashflowSummary;","map":{"version":3,"sources":["D:/actions/st_frontend/src/pages/Cashflow/Summary/index.js"],"names":["Model","myTime","numeral","moment","React","Component","Col","Row","ButtonGroup","Button","BenTabs","BenTable","RankDatePicker","MODE","CashflowSummary","props","_loadAllSum","_getSumary","state","onTab","tabs","icon","code","name","startDate","headMonthEn","endDate","curDateEn","grid_object","colums","headerName","field","width","rowData","grid_bill_account","_setup","model","rows","THU","CHI","map","item","parseInt","thu","chi","object","data","push","_calculateSUM","format","newRow","option","url","doCall","res","ret","_formatForSumObject","_formatForSumBillAccount","setState","status","start","end","str","arr","Object","keys","split","indexOf","count","padding","marginBottom","_loadWithDate","marginLeft","borderLeft"],"mappings":"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","sourcesContent":["\r\n// DATA\r\nimport Model from '../../../model/model';\r\n\r\n// HOOKS \r\nimport {  myTime } from '../../../hook/ultil/myTime';\r\n\r\n// LIBS \r\nimport numeral from 'numeral';\r\nimport moment from 'moment';\r\n\r\nimport React, { Component } from 'react';\r\nimport { Col, Row, ButtonGroup, Button } from 'reactstrap';\r\n\r\n\r\nimport BenTabs from '../../../components/BenTabs';\r\nimport BenTable from '../../../components/BenTable';\r\nimport RankDatePicker from '../../../components/RankDatePicker' ; \r\n\r\n\r\nconst MODE = 'bills';\r\n\r\n\r\nclass CashflowSummary extends Component{\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    \r\n    this.state = {\r\n      onTab:'object',\r\n      tabs:[\r\n        { icon:'fa fa-user', code:'object', name:'Xem theo đối tượng' },\r\n        { icon:'fa fa-credit-card', code:'bill_account', name:'Xem theo tài khoản' }\r\n      ],\r\n\r\n      startDate: myTime.headMonthEn(),\r\n      endDate: myTime.curDateEn()\r\n\r\n    };\r\n\r\n    this.grid_object = {\r\n      colums:[\r\n        { headerName:'Đối tượng', field:'object', width:'50%' },\r\n        { headerName:'Thu', field:'thu',width:'25%' },\r\n        { headerName:'Chi', field:'chi',width:'25%' },\r\n      ],\r\n      rowData:[]\r\n    }\r\n\r\n    this.grid_bill_account = {\r\n      colums:[\r\n        { headerName:'Đối tượng', field:'object', width:'50%' },\r\n        { headerName:'Thu', field:'thu',width:'25%' },\r\n        { headerName:'Chi', field:'chi',width:'25%' },\r\n      ],\r\n      rowData:[]\r\n    }\r\n\r\n    this._setup()\r\n\r\n  }\r\n\r\n  _setup(){\r\n    this.model = new Model(MODE);\r\n\r\n  }\r\n\r\n  _calculateSUM(rows){\r\n    let THU = 0;\r\n    let CHI = 0 ;\r\n\r\n    rows.map((item)=>{\r\n      THU += parseInt(item.thu);\r\n      CHI += parseInt(item.chi);\r\n      \r\n\r\n    });\r\n    \r\n    return {\r\n      object:<span className=\"text-red text-uppercase\"> Tổng </span>,\r\n      thu:THU,\r\n      chi:CHI\r\n    }\r\n\r\n  }\r\n  _formatForSumObject(data){\r\n\r\n    let rows = [];\r\n        rows.push({\r\n          object:'Nhân viên',\r\n          thu: data['USER_THU'] ,\r\n          chi:data['USER_CHI']\r\n        });\r\n\r\n        rows.push({\r\n          object:'Khách hàng',\r\n          thu:data['CUSTOMER_THU'],\r\n          chi:data['CUSTOMER_CHI']\r\n        });\r\n\r\n        rows.push({\r\n          object:'Nhà cung cấp',\r\n          thu:data['SUPPLIER_THU'],\r\n          chi:data['SUPPLIER_CHI']\r\n        });\r\n\r\n        rows.push({\r\n          object:'Khác',\r\n          thu:data['OTHER_THU'],\r\n          chi:data['OTHER_THU']\r\n        });\r\n        \r\n        rows.push(this._calculateSUM(rows));\r\n        \r\n        rows = rows.map((item)=>{\r\n          return {\r\n            object:item.object,\r\n            thu:numeral(item.thu).format('0,0'),\r\n            chi:numeral(item.chi).format('0,0')\r\n          }\r\n        })\r\n        \r\n        \r\n        \r\n    return rows\r\n  }\r\n\r\n  _formatForSumBillAccount(rows){\r\n\r\n    rows.push(this._calculateSUM(rows));\r\n\r\n    let newRow = [];\r\n    rows.map((item)=>{\r\n      newRow.push({\r\n        object:item.object,\r\n        thu:numeral(item.thu).format('0,0'),\r\n        chi:numeral(item.chi).format('0,0')\r\n      })\r\n    });\r\n\r\n    return newRow;\r\n\r\n  }\r\n\r\n  _getSumary(option){\r\n    \r\n    const url = '/sumaryBy/'+option + '?start='+this.state.startDate+'&end='+this.state.endDate;  \r\n\r\n\r\n    this.model.doCall(url,(res)=>{\r\n      const ret = res.data;\r\n      if(ret.name==='success'){\r\n        // FORMAT DATA FIRST\r\n        const data = ret.rows[0]; // RESUM BY OBJECT\r\n        \r\n        switch(option){\r\n          case 'object':\r\n            this['grid_object'].rowData = this._formatForSumObject(data);\r\n          break;\r\n          case 'bill_account':\r\n            this['grid_bill_account'].rowData = this._formatForSumBillAccount(ret.rows);\r\n          break ;\r\n        }\r\n        \r\n        this.setState({\r\n          status:ret.name\r\n        });\r\n\r\n\r\n      }\r\n    });\r\n  }\r\n  componentDidMount(){\r\n    \r\n    this._getSumary('object');\r\n    this._getSumary('bill_account');\r\n    \r\n\r\n  }\r\n  \r\n  _loadWithDate(state){\r\n    this.setState({\r\n      startDate:moment(state.start).format('YYYY-MM-DD'),\r\n      endDate:moment(state.end).format('YYYY-MM-DD'),\r\n    });\r\n\r\n  }\r\n  _loadAllSum = ()=>{\r\n    //alert(JSON.stringify(this.state));\r\n\r\n    this._getSumary('object');\r\n    this._getSumary('bill_account');\r\n\r\n\r\n\r\n  }\r\n\r\n  // DBCABC\r\n  findDup(str){\r\n\r\n    const arr = {};\r\n    \r\n    Object.keys(str.split('')).map((item)=>{\r\n      if(str.indexOf(item)>-1){\r\n        arr.push({\r\n          item:item,\r\n          count:1\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  render(){\r\n    return (\r\n      <div className=\"animated fadeIn\">\r\n        <main className=\"div-main\"> \r\n          <div style={{padding:30}}>\r\n            <h4 className=\"text-uppercase\" style={{marginBottom:15}}> Tổng quan Thu - Chi </h4>\r\n            <Row>\r\n              <Col md={10}>\r\n                <BenTabs onChangeTab={(code)=>{ this.setState({onTab:code}) }}  tabs={this.state.tabs}>\r\n                  <div style={{padding:'30px 0 0 30px'}}>\r\n                    <ButtonGroup>\r\n                      <RankDatePicker onChange={(state)=>{ this._loadWithDate(state) }} />  \r\n                      <Button onClick={this._loadAllSum} style={{marginLeft:-10, borderLeft:0}} className=\"btn btn-ubuntu\">\r\n                        <i className=\"fa fa-filter\"></i>\r\n                      </Button>\r\n                    </ButtonGroup>\r\n\r\n                  </div>\r\n                  {/* TAB ĐỐI TƯỢNG */}\r\n                  <div style={{padding:30}} className={  `tab-pane  ${ this.state.onTab==='object'?'active':'' } ` }>\r\n                      <BenTable\r\n                        grid={this.grid_object}\r\n                        height=\"42vh\"\r\n                      />\r\n                  </div>\r\n                  {/* END TAB ĐỐI TƯỢNG */}\r\n\r\n\r\n                  {/* TAB TÀI KHOẢN */}\r\n                  <div style={{padding:30}} className={  `tab-pane  ${ this.state.onTab==='bill_account'?'active':'' } ` }>\r\n                      <BenTable\r\n                        grid={this.grid_bill_account}\r\n                        height=\"42vh\"\r\n                      />\r\n                  </div>\r\n                  {/* END TAB TÀI KHOẢN */}\r\n                  \r\n\r\n                </BenTabs>  \r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </main>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default CashflowSummary;\r\n"]},"metadata":{},"sourceType":"module"}