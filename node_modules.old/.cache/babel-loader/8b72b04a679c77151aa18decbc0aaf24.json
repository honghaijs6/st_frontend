{"ast":null,"code":"import _classCallCheck from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"D:\\\\actions\\\\st_frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"D:\\\\actions\\\\st_frontend\\\\src\\\\pages\\\\pages\\\\PushSDK\\\\realtimePage.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport { Table, Row, Col, ButtonGroup, Button } from 'reactstrap';\nimport { toast } from \"react-toastify\";\nimport server from '../../../config/server';\nvar MAU_JSON = \"{\\n  \\\"desc\\\": \\\"ok\\\",\\n  \\\"data\\\": [{\\n          \\\"sn\\\": \\\"s\\u1ED1 serial\\\",\\n          \\\"pin\\\": \\\"m\\xE3 pin\\\",\\n          \\\"cardno\\\": \\\"s\\u1ED1 th\\u1EBB\\\",\\n          \\\"inoutstatus\\\": \\\"Tr\\u1EA1ng th\\xE1i IN-OUT\\\",\\n          \\\"time\\\": \\\"Th\\u1EDDi gian khi check th\\u1EBB\\\",\\n          \\\"eventaddr\\\":\\\"c\\u1EEDa-c\\u1ED5ng\\\",\\n          \\\"event\\\":\\\"trang th\\xE1i nguoi d\\xF9ng\\\",\\n          \\\"verifytype\\\":\\\"tr\\u1EA1ng th\\xE1i ch\\u1EA5p nh\\u1EADn - t\\u1EEB ch\\u1ED1i\\\"\\n\\n\\n      }\\n\\n  ]\\n}\";\nvar MAU_JSON2 = \"{\\n  \\\"desc\\\": \\\"ok\\\",\\n}\";\n\nvar RealTimePage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RealTimePage, _React$Component);\n\n  function RealTimePage(props) {\n    var _this;\n\n    _classCallCheck(this, RealTimePage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RealTimePage).call(this, props));\n    _this.state = {\n      server: server.base(),\n      typeAction: '',\n      // post - put - delete ...\n      onAction: '',\n      // string method\n      status: '',\n      viewSupport: false,\n      tab: 'realtimePage',\n      isInitRealtime: false\n    };\n    _this.grid = {\n      columnDefs: [{\n        headerName: \"Device sn\",\n        field: \"sn\",\n        width: 240\n      }, {\n        headerName: \"Pin\",\n        field: \"pin\",\n        width: 200\n      }, {\n        headerName: \"CardNo\",\n        field: \"cardno\",\n        width: 140\n      }, {\n        headerName: \"In/Out\",\n        field: \"inoutstatus\",\n        width: 100\n      }, {\n        headerName: \"Time\",\n        field: \"time\",\n        width: 200\n      }, {\n        headerName: \"Event Point\",\n        field: \"eventaddr\",\n        width: 200\n      }, {\n        headerName: \"Event Type\",\n        field: \"event\",\n        width: 200\n      }, {\n        headerName: \"Verification Type\",\n        field: \"verifytype\",\n        width: 200\n      }],\n      rowData: []\n    };\n    _this._viewSupport = _this._viewSupport.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(RealTimePage, [{\n    key: \"_viewSupport\",\n    value: function _viewSupport() {\n      this.setState({\n        viewSupport: !this.state.viewSupport\n      });\n    }\n  }, {\n    key: \"_openDoor\",\n    value: function _openDoor(json) {\n      var url = server.base() + '/pushapi/createCmd?cmdType=userDefined&sn=' + json.sn + '&originalCmd=CONTROL DEVICE 01010103';\n      toast.info('Đã mở khoá ');\n      axios.post(url).then(function (responese) {\n        var res = responese.data;\n        toast.info('Khoá đã đóng : ' + json.sn);\n        /*if(res.desc==='ok'){\r\n             toast.info('Đã mở khoá : '+json.sn);\r\n        }*/\n      });\n    }\n  }, {\n    key: \"_synchronize\",\n    value: function _synchronize(json) {\n      var url = server.base() + '/pushapi/deviceServlet?type=2&sn=' + json.sn;\n      axios.post(url).then(function (responese) {\n        var res = responese.data;\n\n        if (res.desc === 'ok') {\n          toast.info('Đã đồng bộ  : ' + json.sn);\n        }\n      });\n    }\n  }, {\n    key: \"_realEvent\",\n    value: function _realEvent(status) {\n      var _this2 = this;\n\n      var url = server.base() + '/pushapi/realEvent';\n      this.state.isInitRealtime = status;\n      axios.post(url).then(function (responese) {\n        var res = responese.data;\n\n        if (res.desc === 'ok') {\n          console.log(res.data);\n\n          if (res.data.length > 0) {\n            res.data.map(function (item) {\n              _this2.grid.rowData.push(item);\n            });\n\n            _this2.setState({\n              onAction: '_realEvent'\n            });\n          }\n\n          if (_this2.state.isInitRealtime !== false) {\n            _this2._realEvent(true);\n          }\n        }\n      });\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(newProps) {\n      if (newProps.onTab === this.state.tab) {\n        if (!this.state.isInitRealtime) {\n          this._realEvent(true);\n        }\n      } else {\n        this._realEvent(false);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        style: {\n          padding: 30\n        },\n        hidden: this.props.onTab === this.state.tab ? false : true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this._viewSupport,\n        className: \"btn btn-sm btn-success\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, \" \", React.createElement(\"i\", {\n        className: \"fa fa-support mr-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }), \" H\\u01B0\\u1EDBng d\\u1EA9n \")), React.createElement(\"div\", {\n        hidden: !this.state.viewSupport ? false : true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(Table, {\n        className: \"table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        style: {\n          border: 0,\n          background: '#222D32',\n          color: '#fff'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        style: {\n          width: 30\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, \"#\"), this.grid.columnDefs.map(function (item, index) {\n        return React.createElement(\"th\", {\n          key: index,\n          style: {\n            width: item.width\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, \" \", item.headerName, \" \");\n      }), React.createElement(\"th\", {\n        style: {\n          width: 180\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, \"Operation\"))), React.createElement(\"tbody\", {\n        style: {\n          height: '74vh'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, this.grid.rowData.map(function (item, index) {\n        var stt = index + 1;\n        return React.createElement(\"tr\", {\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          style: {\n            width: 30\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, stt), _this3.grid.columnDefs.map(function (item2, index2) {\n          return React.createElement(\"td\", {\n            key: index2,\n            style: {\n              width: item2.width + 'px'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 209\n            },\n            __self: this\n          }, \" \", item[item2['field']]);\n        }));\n      })))), React.createElement(\"div\", {\n        style: {\n          fontFamily: 'Roboto'\n        },\n        hidden: !this.state.viewSupport ? true : false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"guidebook\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, \" Thao t\\xE1c v\\u1EC1 Realtime  \"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, \"  Ph\\u1EA7n n\\xE0y l\\xE0 h\\u01B0\\u1EDBng d\\u1EA9n cho ch\\u01B0\\u01A1ng tr\\xECnh demo v\\u1EC1 l\\u1EA5y tr\\u1EA1ng th\\xE1i c\\u1EE7a thi\\u1EBFt b\\u1ECB khi c\\xF3 t\\u01B0\\u01A1ng t\\xE1c \\u0111\\u1EA7u \\u0111\\u1ECDc th\\u1EBB  \"), React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \" Request \"), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, \" URL: /pushapi/realEvent\"), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \" Method : POST \")), React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, \" Responese \"), React.createElement(\"pre\", {\n        style: {\n          background: '#263238',\n          color: '#f1f1f1',\n          padding: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, MAU_JSON), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"M\\u1EB7c \\u0111\\u1ECBnh l\\xE0 t\\u1EA5t c\\u1EA3 c\\xE1c thi\\u1EBFt b\\u1ECB khi k\\u1EBFt n\\u1ED1i v\\xE0o Push server n\\xF3 s\\u1EBD lu\\xF4n tr\\u1EA3 t\\xEDn hi\\u1EC7u tr\\u1EA1ng th\\xE1i v\\u1EC1 Push server cloud, c\\xF4ng vi\\u1EC7c c\\u1EE7a nh\\xE0 ph\\xE1t tri\\u1EC3n l\\xE0 t\\u1EA1o ra 1 c\\u01A1 ch\\u1EBF poll, \\u0111\\u1EC7 quy \\u0111\\u1EC3 li\\xEAn t\\u1EE5c l\\u1EA5y t\\xEDn hi\\u1EC7u n\\xE0y\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return RealTimePage;\n}(React.Component);\n\nexport { RealTimePage as default };","map":{"version":3,"sources":["D:/actions/st_frontend/src/pages/pages/PushSDK/realtimePage.js"],"names":["React","axios","Table","Row","Col","ButtonGroup","Button","toast","server","MAU_JSON","MAU_JSON2","RealTimePage","props","state","base","typeAction","onAction","status","viewSupport","tab","isInitRealtime","grid","columnDefs","headerName","field","width","rowData","_viewSupport","bind","setState","json","url","sn","info","post","then","responese","res","data","desc","console","log","length","map","item","push","_realEvent","newProps","onTab","padding","marginBottom","border","background","color","index","height","stt","item2","index2","fontFamily","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport { Table, Row, Col, ButtonGroup, Button } from 'reactstrap';\r\n\r\n\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport server from '../../../config/server';\r\n\r\n\r\n\r\nconst MAU_JSON = `{\r\n  \"desc\": \"ok\",\r\n  \"data\": [{\r\n          \"sn\": \"số serial\",\r\n          \"pin\": \"mã pin\",\r\n          \"cardno\": \"số thẻ\",\r\n          \"inoutstatus\": \"Trạng thái IN-OUT\",\r\n          \"time\": \"Thời gian khi check thẻ\",\r\n          \"eventaddr\":\"cửa-cổng\",\r\n          \"event\":\"trang thái nguoi dùng\",\r\n          \"verifytype\":\"trạng thái chấp nhận - từ chối\"\r\n\r\n\r\n      }\r\n\r\n  ]\r\n}`;\r\n\r\nconst MAU_JSON2 = `{\r\n  \"desc\": \"ok\",\r\n}`;\r\n\r\n\r\nexport default class RealTimePage extends React.Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      server: server.base(),\r\n      typeAction:'', // post - put - delete ...\r\n      onAction:'', // string method\r\n      status:'',\r\n      viewSupport:false,\r\n\r\n      tab:'realtimePage',\r\n\r\n      isInitRealtime:false\r\n\r\n    }\r\n\r\n    this.grid = {\r\n      columnDefs:[\r\n        {headerName: \"Device sn\", field: \"sn\",width:240},\r\n        {headerName: \"Pin\", field: \"pin\",width:200},\r\n        {headerName: \"CardNo\", field: \"cardno\",width:140},\r\n        {headerName: \"In/Out\", field: \"inoutstatus\",width:100},\r\n        {headerName: \"Time\", field: \"time\",width:200},\r\n\r\n        {headerName: \"Event Point\", field: \"eventaddr\",width:200},\r\n        {headerName: \"Event Type\", field: \"event\",width:200},\r\n        {headerName: \"Verification Type\", field: \"verifytype\",width:200}\r\n\r\n\r\n\r\n      ],\r\n      rowData: []\r\n    }\r\n\r\n    this._viewSupport = this._viewSupport.bind(this);\r\n\r\n  }\r\n\r\n  _viewSupport(){\r\n    this.setState({\r\n      viewSupport: !this.state.viewSupport\r\n    })\r\n  }\r\n\r\n  _openDoor(json){\r\n\r\n    const url = server.base()+'/pushapi/createCmd?cmdType=userDefined&sn='+json.sn+'&originalCmd=CONTROL DEVICE 01010103';\r\n    toast.info('Đã mở khoá ');\r\n    axios.post(url).then((responese)=>{\r\n      const res = responese.data ;\r\n\r\n      toast.info('Khoá đã đóng : '+json.sn);\r\n\r\n      /*if(res.desc==='ok'){\r\n           toast.info('Đã mở khoá : '+json.sn);\r\n      }*/\r\n\r\n    })\r\n  }\r\n\r\n  _synchronize(json){\r\n    const url = server.base()+'/pushapi/deviceServlet?type=2&sn='+json.sn;\r\n    axios.post(url).then((responese)=>{\r\n      const res = responese.data ;\r\n\r\n      if(res.desc==='ok'){\r\n           toast.info('Đã đồng bộ  : '+json.sn);\r\n      }\r\n\r\n\r\n    })\r\n\r\n\r\n  }\r\n\r\n  _realEvent(status){\r\n    const url = server.base()+'/pushapi/realEvent';\r\n\r\n    this.state.isInitRealtime = status;\r\n\r\n    axios.post(url).then((responese)=>{\r\n      const res = responese.data ;\r\n      if(res.desc==='ok'){\r\n\r\n        console.log(res.data);\r\n      \r\n        if(res.data.length>0){\r\n\r\n          res.data.map((item)=>{\r\n            this.grid.rowData.push(item)\r\n          })\r\n\r\n          this.setState({\r\n            onAction:'_realEvent'\r\n          })\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n        if(this.state.isInitRealtime !== false){\r\n          this._realEvent(true);\r\n        }\r\n\r\n\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n\r\n  componentWillReceiveProps(newProps){\r\n    if(newProps.onTab===this.state.tab){\r\n      if(!this.state.isInitRealtime){\r\n\r\n         this._realEvent(true) ;\r\n\r\n      }\r\n    }else{ this._realEvent(false) }\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n\r\n    return (\r\n      <div style={{padding:30}} hidden={  this.props.onTab === this.state.tab ? false : true } >\r\n\r\n          <div style={{marginBottom:20}}>\r\n            <button onClick={this._viewSupport} className=\"btn btn-sm btn-success\"> <i className=\"fa fa-support mr-5\" /> Hướng dẩn </button>\r\n          </div>\r\n\r\n          <div hidden={!this.state.viewSupport ? false : true } >\r\n            <Table  className=\"table\" >\r\n              <thead style={{ border:0, background:'#222D32', color:'#fff' }} >\r\n                <tr>\r\n                  <th style={{width: 30}}>\r\n                      #\r\n                  </th>\r\n                  {\r\n                    this.grid.columnDefs.map((item,index)=>{\r\n                      return(\r\n                        <th key={index} style={{\r\n                          width: item.width\r\n                        }} > { item.headerName } </th>\r\n                      )\r\n                    })\r\n                  }\r\n                  <th style={{width: 180}}>\r\n                    Operation\r\n                  </th>\r\n\r\n\r\n                </tr>\r\n              </thead>\r\n\r\n              <tbody style={{height: '74vh'}}>\r\n                {\r\n                  this.grid.rowData.map((item,index)=>{\r\n\r\n                    let stt = index + 1 ;\r\n                    return(\r\n                      <tr key={index}>\r\n                        <td style={{width: 30}}>\r\n                          { stt }\r\n                        </td>\r\n                        {\r\n                          this.grid.columnDefs.map((item2,index2)=>{\r\n                              return(\r\n                                <td key={index2} style={{\r\n                                  width: item2.width+'px'\r\n                                }}> { item[item2['field']] }\r\n\r\n                                </td>\r\n                              )\r\n                          })\r\n                        }\r\n                      </tr>\r\n                    )\r\n                  })\r\n                }\r\n\r\n              </tbody>\r\n\r\n\r\n            </Table>\r\n          </div>\r\n\r\n\r\n          <div style={{ fontFamily:'Roboto'}} hidden={ !this.state.viewSupport ? true : false }>\r\n              <div className=\"guidebook\">\r\n\r\n              <h3> Thao tác về Realtime  </h3>\r\n              <p>  Phần này là hướng dẩn cho chương trình demo về lấy trạng thái của thiết bị khi có tương tác đầu đọc thẻ  </p>\r\n\r\n              <h5> Request </h5>\r\n              <ul>\r\n                  <li> URL: /pushapi/realEvent</li>\r\n                  <li> Method : POST </li>\r\n              </ul>\r\n              <h5> Responese </h5>\r\n\r\n                <pre style={{\r\n                  background:'#263238',\r\n                  color:'#f1f1f1',\r\n                  padding:20\r\n                }}>\r\n                  { MAU_JSON }\r\n                </pre>\r\n\r\n                <p>\r\n                  Mặc định là tất cả các thiết bị khi kết nối vào Push server nó sẽ luôn trả tín hiệu trạng thái về Push server cloud,\r\n                  công việc của nhà phát triển là tạo ra 1 cơ chế poll, đệ quy để liên tục lấy tín hiệu này\r\n                </p>\r\n\r\n                <br></br>\r\n                <br></br>\r\n\r\n                <br></br>\r\n                <br></br>\r\n              </div>\r\n          </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}